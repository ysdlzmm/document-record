# React çŠ¶æ€ç®¡ç†

## ä¸€ã€çŠ¶æ€ç®¡ç†æ¦‚è¿°

### 1.1 ä¸ºä»€ä¹ˆéœ€è¦çŠ¶æ€ç®¡ç†ï¼Ÿ

**åœºæ™¯æ¼”è¿›**

```jsx
// é˜¶æ®µ 1ï¼šç»„ä»¶å†…éƒ¨çŠ¶æ€ï¼ˆç®€å•åœºæ™¯ï¼‰
function Counter() {
  const [count, setCount] = useState(0);
  return <button onClick={() => setCount(count + 1)}>{count}</button>;
}

// é˜¶æ®µ 2ï¼šProps ä¼ é€’ï¼ˆä¸­ç­‰åœºæ™¯ï¼‰
function App() {
  const [user, setUser] = useState(null);
  return (
    <>
      <Header user={user} />
      <Main user={user} setUser={setUser} />
      <Footer user={user} />
    </>
  );
}

// é—®é¢˜ï¼šProps é€å±‚ä¼ é€’ï¼ˆProp Drillingï¼‰
function App() {
  const [theme, setTheme] = useState('light');
  return (
    <Page>
      <Section>
        <Component>
          <SubComponent theme={theme} setTheme={setTheme} />
        </Component>
      </Section>
    </Page>
  );
}

// é˜¶æ®µ 3ï¼šContext APIï¼ˆè·¨ç»„ä»¶å…±äº«ï¼‰
const ThemeContext = createContext();

function App() {
  const [theme, setTheme] = useState('light');
  return (
    <ThemeContext.Provider value={{ theme, setTheme }}>
      <Page />
    </ThemeContext.Provider>
  );
}

// é˜¶æ®µ 4ï¼šçŠ¶æ€ç®¡ç†åº“ï¼ˆå¤æ‚åº”ç”¨ï¼‰
// - Reduxï¼šå¤§å‹åº”ç”¨ã€å¯é¢„æµ‹çš„çŠ¶æ€æ›´æ–°
// - Zustandï¼šè½»é‡çº§ã€ç®€æ´
// - Jotaiï¼šåŸå­åŒ–çŠ¶æ€
// - Recoilï¼šFacebook å‡ºå“
```

### 1.2 çŠ¶æ€ç®¡ç†æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | é€‚ç”¨åœºæ™¯ | ä¼˜åŠ¿ | åŠ£åŠ¿ |
|------|----------|------|------|
| **useState + Context** | ä¸­å°å‹åº”ç”¨ | React å†…ç½®ã€æ— éœ€é¢å¤–ä¾èµ– | é¢‘ç¹æ›´æ–°æ€§èƒ½é—®é¢˜ |
| **Redux Toolkit** | å¤§å‹åº”ç”¨ | ç”Ÿæ€ä¸°å¯Œã€DevTools å¼ºå¤§ | æ ·æ¿ä»£ç å¤šã€å­¦ä¹ æ›²çº¿é™¡ |
| **Zustand** | ä¸­å°å‹åº”ç”¨ | ç®€æ´ã€æ€§èƒ½å¥½ã€æ— æ ·æ¿ä»£ç  | ç”Ÿæ€ç›¸å¯¹è¾ƒå° |
| **Jotai** | ç»„ä»¶çº§çŠ¶æ€ | åŸå­åŒ–ã€çµæ´»ã€Tree-shaking | éœ€è¦æ”¹å˜æ€ç»´æ–¹å¼ |
| **Recoil** | å¤æ‚æ•°æ®æµ | Facebook æ”¯æŒã€åŠŸèƒ½å¼ºå¤§ | ä»å¤„äºå®éªŒé˜¶æ®µ |
| **MobX** | å“åº”å¼çŠ¶æ€ | è‡ªåŠ¨è¿½è¸ªã€ç®€å•æ˜“ç”¨ | é­”æ³•è¿‡å¤šã€è°ƒè¯•å›°éš¾ |

---

## äºŒã€Context API æ·±å…¥

### 2.1 åŸºç¡€ç”¨æ³•

```jsx
import { createContext, useContext, useState } from 'react';

// 1. åˆ›å»º Context
const UserContext = createContext(null);

// 2. åˆ›å»º Provider ç»„ä»¶
function UserProvider({ children }) {
  const [user, setUser] = useState(null);
  const [isLoading, setIsLoading] = useState(false);

  const login = async (credentials) => {
    setIsLoading(true);
    try {
      const data = await api.login(credentials);
      setUser(data);
    } finally {
      setIsLoading(false);
    }
  };

  const logout = () => {
    setUser(null);
  };

  const value = {
    user,
    isLoading,
    login,
    logout
  };

  return (
    <UserContext.Provider value={value}>
      {children}
    </UserContext.Provider>
  );
}

// 3. åˆ›å»ºè‡ªå®šä¹‰ Hook
function useUser() {
  const context = useContext(UserContext);
  if (!context) {
    throw new Error('useUser must be used within UserProvider');
  }
  return context;
}

// 4. ä½¿ç”¨ Context
function LoginPage() {
  const { login, isLoading } = useUser();

  const handleSubmit = (credentials) => {
    login(credentials);
  };

  return <LoginForm onSubmit={handleSubmit} isLoading={isLoading} />;
}

function UserProfile() {
  const { user, logout } = useUser();

  if (!user) return <div>è¯·ç™»å½•</div>;

  return (
    <div>
      <h1>æ¬¢è¿, {user.name}</h1>
      <button onClick={logout}>é€€å‡º</button>
    </div>
  );
}

// 5. åº”ç”¨æ ¹ç»„ä»¶
function App() {
  return (
    <UserProvider>
      <LoginPage />
      <UserProfile />
    </UserProvider>
  );
}
```

### 2.2 ä¼˜åŒ– Context æ€§èƒ½

```jsx
// âŒ é—®é¢˜ï¼šä»»ä½•çŠ¶æ€æ›´æ–°éƒ½ä¼šå¯¼è‡´æ‰€æœ‰æ¶ˆè´¹è€…é‡æ–°æ¸²æŸ“
const DataContext = createContext();

function DataProvider({ children }) {
  const [data1, setData1] = useState(null);
  const [data2, setData2] = useState(null);
  const [data3, setData3] = useState(null);

  return (
    <DataContext.Provider value={{ data1, data2, data3, setData1, setData2, setData3 }}>
      {children}
    </DataContext.Provider>
  );
}

// âœ… æ–¹æ¡ˆ 1ï¼šæ‹†åˆ† Context
const Data1Context = createContext();
const Data2Context = createContext();
const Data3Context = createContext();

function App() {
  return (
    <Data1Provider>
      <Data2Provider>
        <Data3Provider>
          <Component />
        </Data3Provider>
      </Data2Provider>
    </Data1Provider>
  );
}

// âœ… æ–¹æ¡ˆ 2ï¼šä½¿ç”¨ useMemo ç¼“å­˜ value
function DataProvider({ children }) {
  const [data1, setData1] = useState(null);
  const [data2, setData2] = useState(null);

  const value = useMemo(
    () => ({ data1, data2, setData1, setData2 }),
    [data1, data2]
  );

  return (
    <DataContext.Provider value={value}>
      {children}
    </DataContext.Provider>
  );
}

// âœ… æ–¹æ¡ˆ 3ï¼šåˆ†ç¦»çŠ¶æ€å’Œæ›´æ–°å‡½æ•°
const StateContext = createContext();
const DispatchContext = createContext();

function DataProvider({ children }) {
  const [state, dispatch] = useReducer(dataReducer, initialState);

  return (
    <StateContext.Provider value={state}>
      <DispatchContext.Provider value={dispatch}>
        {children}
      </DispatchContext.Provider>
    </StateContext.Provider>
  );
}

function Component() {
  const state = useContext(StateContext);        // ä»…åœ¨ state å˜åŒ–æ—¶é‡æ¸²æŸ“
  const dispatch = useContext(DispatchContext); // æ°¸ä¸å˜åŒ–

  return <div>{state.data}</div>;
}
```

### 2.3 å¤æ‚ Context åœºæ™¯

```jsx
// åµŒå¥— Context
const ThemeContext = createContext();
const LanguageContext = createContext();

function App() {
  return (
    <ThemeProvider>
      <LanguageProvider>
        <Page />
      </LanguageProvider>
    </ThemeProvider>
  );
}

// ç»„åˆå¤šä¸ª Context
function useAppContext() {
  const theme = useContext(ThemeContext);
  const language = useContext(LanguageContext);

  return { theme, language };
}

// åŠ¨æ€ Context
const ConfigContext = createContext();

function ConfigProvider({ config, children }) {
  // åˆå¹¶é»˜è®¤é…ç½®
  const value = useMemo(
    () => ({
      ...defaultConfig,
      ...config
    }),
    [config]
  );

  return (
    <ConfigContext.Provider value={value}>
      {children}
    </ConfigContext.Provider>
  );
}

// æ¡ä»¶ Context
const AdminContext = createContext();

function App({ isAdmin }) {
  return (
    <AdminContext.Provider value={isAdmin}>
      {isAdmin ? <AdminPanel /> : <UserPanel />}
    </AdminContext.Provider>
  );
}
```

---

## ä¸‰ã€Redux Toolkitï¼ˆæ¨èï¼‰

### 3.1 æ ¸å¿ƒæ¦‚å¿µ

```typescript
// store/usersSlice.ts
import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';

// å¼‚æ­¥ Action
export const fetchUsers = createAsyncThunk(
  'users/fetchUsers',
  async () => {
    const response = await api.getUsers();
    return response.data;
  }
);

// åˆ›å»º Slice
const usersSlice = createSlice({
  name: 'users',
  initialState: {
    items: [],
    loading: false,
    error: null
  },
  reducers: {
    // åŒæ­¥ reducer
    addUser: (state, action) => {
      state.items.push(action.payload);
    },
    removeUser: (state, action) => {
      state.items = state.items.filter(user => user.id !== action.payload);
    },
    updateUser: (state, action) => {
      const index = state.items.findIndex(user => user.id === action.payload.id);
      if (index !== -1) {
        state.items[index] = action.payload;
      }
    }
  },
  extraReducers: (builder) => {
    // å¼‚æ­¥ reducer
    builder
      .addCase(fetchUsers.pending, (state) => {
        state.loading = true;
        state.error = null;
      })
      .addCase(fetchUsers.fulfilled, (state, action) => {
        state.loading = false;
        state.items = action.payload;
      })
      .addCase(fetchUsers.rejected, (state, action) => {
        state.loading = false;
        state.error = action.error.message;
      });
  }
});

export const { addUser, removeUser, updateUser } = usersSlice.actions;
export default usersSlice.reducer;
```

### 3.2 é…ç½® Store

```typescript
// store/index.ts
import { configureStore } from '@reduxjs/toolkit';
import usersReducer from './usersSlice';
import postsReducer from './postsSlice';

export const store = configureStore({
  reducer: {
    users: usersReducer,
    posts: postsReducer
  },
  middleware: (getDefaultMiddleware) =>
    getDefaultMiddleware({
      serializableCheck: false // ç¦ç”¨åºåˆ—åŒ–æ£€æŸ¥ï¼ˆæŸäº›åœºæ™¯éœ€è¦ï¼‰
    })
});

// ç±»å‹æ¨æ–­
export type RootState = ReturnType<typeof store.getState>;
export type AppDispatch = typeof store.dispatch;
```

### 3.3 ç±»å‹å®‰å…¨çš„ Hooks

```typescript
// store/hooks.ts
import { TypedUseSelectorHook, useDispatch, useSelector } from 'react-redux';
import type { RootState, AppDispatch } from './index';

// ç±»å‹åŒ–çš„ hooks
export const useAppDispatch = () => useDispatch<AppDispatch>();
export const useAppSelector: TypedUseSelectorHook<RootState> = useSelector;
```

### 3.4 åœ¨ç»„ä»¶ä¸­ä½¿ç”¨

```tsx
// components/UsersList.tsx
import { useEffect } from 'react';
import { useAppDispatch, useAppSelector } from '../store/hooks';
import { fetchUsers, addUser, removeUser } from '../store/usersSlice';

function UsersList() {
  const dispatch = useAppDispatch();
  const { items, loading, error } = useAppSelector(state => state.users);

  useEffect(() => {
    dispatch(fetchUsers());
  }, [dispatch]);

  const handleAddUser = () => {
    const newUser = { id: Date.now(), name: 'æ–°ç”¨æˆ·' };
    dispatch(addUser(newUser));
  };

  const handleRemoveUser = (id) => {
    dispatch(removeUser(id));
  };

  if (loading) return <div>åŠ è½½ä¸­...</div>;
  if (error) return <div>é”™è¯¯: {error}</div>;

  return (
    <div>
      <button onClick={handleAddUser}>æ·»åŠ ç”¨æˆ·</button>
      <ul>
        {items.map(user => (
          <li key={user.id}>
            {user.name}
            <button onClick={() => handleRemoveUser(user.id)}>åˆ é™¤</button>
          </li>
        ))}
      </ul>
    </div>
  );
}
```

### 3.5 Redux ä¸­é—´ä»¶

```typescript
// è‡ªå®šä¹‰ logger ä¸­é—´ä»¶
const loggerMiddleware = (store) => (next) => (action) => {
  console.log('Dispatching:', action);
  const result = next(action);
  console.log('Next State:', store.getState());
  return result;
};

// ä½¿ç”¨ Redux Saga å¤„ç†å¤æ‚å¼‚æ­¥
import { createSagaMiddleware } from 'redux-saga';
import { takeEvery, put, call } from 'redux-saga/effects';

function* fetchUsersSaga() {
  try {
    const data = yield call(api.getUsers);
    yield put({ type: 'users/fetchUsers/fulfilled', payload: data });
  } catch (error) {
    yield put({ type: 'users/fetchUsers/rejected', error });
  }
}

function* rootSaga() {
  yield takeEvery('users/fetchUsers/pending', fetchUsersSaga);
}

const sagaMiddleware = createSagaMiddleware();

export const store = configureStore({
  reducer: { /* ... */ },
  middleware: (getDefaultMiddleware) =>
    getDefaultMiddleware().concat(loggerMiddleware, sagaMiddleware)
});

sagaMiddleware.run(rootSaga);
```

---

## å››ã€Zustandï¼ˆè½»é‡çº§ï¼‰

### 4.1 åŸºç¡€ç”¨æ³•

```typescript
// store/userStore.ts
import { create } from 'zustand';

interface User {
  id: number;
  name: string;
  email: string;
}

interface UserStore {
  user: User | null;
  isLoading: boolean;
  login: (credentials: Credentials) => Promise<void>;
  logout: () => void;
}

export const useUserStore = create<UserStore>((set) => ({
  user: null,
  isLoading: false,

  login: async (credentials) => {
    set({ isLoading: true });
    try {
      const user = await api.login(credentials);
      set({ user, isLoading: false });
    } catch (error) {
      set({ isLoading: false });
      throw error;
    }
  },

  logout: () => {
    set({ user: null });
  }
}));
```

### 4.2 åœ¨ç»„ä»¶ä¸­ä½¿ç”¨

```tsx
// components/LoginForm.tsx
function LoginForm() {
  const { login, isLoading } = useUserStore();

  const handleSubmit = async (credentials) => {
    try {
      await login(credentials);
      // ç™»å½•æˆåŠŸ
    } catch (error) {
      // å¤„ç†é”™è¯¯
    }
  };

  return (
    <form onSubmit={handleSubmit}>
      <input name="username" />
      <input name="password" type="password" />
      <button type="submit" disabled={isLoading}>
        {isLoading ? 'ç™»å½•ä¸­...' : 'ç™»å½•'}
      </button>
    </form>
  );
}

// é€‰æ‹©ç‰¹å®šçŠ¶æ€ï¼ˆä¼˜åŒ–æ€§èƒ½ï¼‰
function UserProfile() {
  // ä»…åœ¨ user å˜åŒ–æ—¶é‡æ¸²æŸ“
  const user = useUserStore(state => state.user);
  const logout = useUserStore(state => state.logout);

  if (!user) return <div>è¯·ç™»å½•</div>;

  return (
    <div>
      <h1>{user.name}</h1>
      <button onClick={logout}>é€€å‡º</button>
    </div>
  );
}
```

### 4.3 ä¸­é—´ä»¶

```typescript
import { devtools, persist } from 'zustand/middleware';

// å¼€å‘è€…å·¥å…·
export const useUserStore = create(
  devtools(
    (set) => ({
      user: null,
      login: async (credentials) => {
        const user = await api.login(credentials);
        set({ user });
      }
    }),
    { name: 'UserStore' }
  )
);

// æŒä¹…åŒ–ï¼ˆlocalStorageï¼‰
export const useAuthStore = create(
  persist(
    (set) => ({
      token: null,
      setToken: (token) => set({ token })
    }),
    {
      name: 'auth-storage', // localStorage key
      partialize: (state) => ({ token: state.token }) // ä»…æŒä¹…åŒ–éƒ¨åˆ†çŠ¶æ€
    }
  )
);

// ç»„åˆå¤šä¸ªä¸­é—´ä»¶
export const useStore = create(
  devtools(
    persist(
      (set) => ({
        /* ... */
      }),
      { name: 'app-storage' }
    )
  )
);
```

### 4.4 å¼‚æ­¥ Action

```typescript
import { create } from 'zustand';

// æ–¹å¼ 1ï¼šåœ¨ action ä¸­ç›´æ¥å¤„ç†
export const useTodoStore = create((set, get) => ({
  todos: [],
  loading: false,

  fetchTodos: async () => {
    set({ loading: true });
    try {
      const todos = await api.getTodos();
      set({ todos, loading: false });
    } catch (error) {
      set({ loading: false });
    }
  },

  // ä½¿ç”¨ get() è®¿é—®å…¶ä»– state
  addTodo: async (text) => {
    const newTodo = await api.addTodo(text);
    set(state => ({
      todos: [...state.todos, newTodo]
    }));
  }
}));
```

---

## äº”ã€Jotaiï¼ˆåŸå­åŒ–çŠ¶æ€ï¼‰

### 5.1 æ ¸å¿ƒæ¦‚å¿µ

```typescript
// atoms.ts
import { atom } from 'jotai';

// åŸå­ï¼ˆatomï¼‰= æœ€å°çŠ¶æ€å•å…ƒ
export const countAtom = atom(0);

// åªè¯» atom
export const timeAtom = atom((get) => new Date().toLocaleString());

// è®¡ç®— atomï¼ˆderived atomï¼‰
export const doubleCountAtom = atom((get) => get(countAtom) * 2);

// å¯å†™ atom
export const countWithLogAtom = atom(
  (get) => get(countAtom),
  (get, set, arg) => {
    set(countAtom, arg);
    console.log('Count updated:', arg);
  }
);

// å¼‚æ­¥ atom
export const userAtom = atom(async (get) => {
  const response = await fetch('https://api.example.com/user');
  return response.json();
});
```

### 5.2 åœ¨ç»„ä»¶ä¸­ä½¿ç”¨

```tsx
import { useAtom, useAtomValue, useSetAtom } from 'jotai';

function Counter() {
  const [count, setCount] = useAtom(countAtom);

  return (
    <div>
      <p>Count: {count}</p>
      <button onClick={() => setCount(count + 1)}>å¢åŠ </button>
    </div>
  );
}

// ä»…è¯»å–ï¼ˆä¼˜åŒ–æ€§èƒ½ï¼‰
function CountDisplay() {
  const count = useAtomValue(countAtom);
  return <div>Count: {count}</div>;
}

// ä»…å†™å…¥
function CountControls() {
  const setCount = useSetAtom(countAtom);
  return (
    <button onClick={() => setCount(c => c + 1)}>å¢åŠ </button>
  );
}
```

### 5.3 åŸå­å®¶æ—

```typescript
import { atomFamily } from 'jotai/utils';

// åˆ›å»ºä¸€ç³»åˆ—ç›¸å…³çš„ atom
const todoAtomFamily = atomFamily((id: number) =>
  atom({
    id,
    text: '',
    completed: false
  })
);

// ä½¿ç”¨
function TodoItem({ id }) {
  const [todo, setTodo] = useAtom(todoAtomFamily(id));

  return (
    <div>
      <input
        type="checkbox"
        checked={todo.completed}
        onChange={(e) => setTodo({ ...todo, completed: e.target.checked })}
      />
      <input
        value={todo.text}
        onChange={(e) => setTodo({ ...todo, text: e.target.value })}
      />
    </div>
  );
}
```

---

## å…­ã€çŠ¶æ€ç®¡ç†æœ€ä½³å®è·µ

### 6.1 é€‰æ‹©åŸåˆ™

```
ç®€å•çŠ¶æ€ï¼ˆUI äº¤äº’ï¼‰
  â†“ useState
ç»„ä»¶æ ‘å…±äº«ï¼ˆ2-3 å±‚ï¼‰
  â†“ Props
è·¨ç»„ä»¶å…±äº«ï¼ˆå¤šå±‚ï¼‰
  â†“ Context API
å¤æ‚çŠ¶æ€ï¼ˆå¤šä¸ª reducerã€ä¸­é—´ä»¶ï¼‰
  â†“ Redux Toolkit
è½»é‡çº§éœ€æ±‚ï¼ˆä¸­å°å‹é¡¹ç›®ï¼‰
  â†“ Zustand
ç»†ç²’åº¦çŠ¶æ€ï¼ˆç»„ä»¶çº§ï¼‰
  â†“ Jotai
```

### 6.2 çŠ¶æ€åˆ’åˆ†

```typescript
// UI çŠ¶æ€ - ç»„ä»¶å†…éƒ¨
const [isOpen, setIsOpen] = useState(false);
const [selectedId, setSelectedId] = useState(null);

// è¡¨å•çŠ¶æ€ - ç»„ä»¶å†…éƒ¨
const [formData, setFormData] = useState({ username: '', password: '' });

// æœåŠ¡å™¨çŠ¶æ€ - ä½¿ç”¨ React Query/SWR
const { data, error, isLoading } = useQuery('users', fetchUsers);

// å…¨å±€çŠ¶æ€ - çŠ¶æ€ç®¡ç†åº“
const { user, theme, locale } = useAppStore();

// URL çŠ¶æ€ - ä½¿ç”¨è·¯ç”±
const searchParams = useSearchParams();
const page = searchParams.get('page');
```

### 6.3 æ•°æ®æµå‘

```typescript
// å•å‘æ•°æ®æµ
[User Input] â†’ [Action] â†’ [Reducer/Handler] â†’ [State Update] â†’ [View Update]

// ç¤ºä¾‹
// 1. ç”¨æˆ·äº¤äº’
<button onClick={() => dispatch(addTodo(text))} />

// 2. Action
{ type: 'todo/add', payload: { id: 1, text: 'Learn Redux' } }

// 3. Reducer
function todosReducer(state, action) {
  return [...state, action.payload];
}

// 4. State Update
{ todos: [{ id: 1, text: 'Learn Redux' }] }

// 5. View Update
todos.map(todo => <Todo key={todo.id} {...todo} />)
```

### 6.4 æ€§èƒ½ä¼˜åŒ–

```typescript
// âœ… é€‰æ‹©æœ€å°çŠ¶æ€
function UserList() {
  // âŒ é€‰æ‹©æ•´ä¸ª state
  const state = useAppSelector(state => state);

  // âœ… ä»…é€‰æ‹©éœ€è¦çš„æ•°æ®
  const users = useAppSelector(state => state.users.items);
  const loading = useAppSelector(state => state.users.loading);
}

// âœ… ä½¿ç”¨ useMemo ç¼“å­˜è®¡ç®—ç»“æœ
const activeUsers = useMemo(
  () => users.filter(user => user.isActive),
  [users]
);

// âœ… ä½¿ç”¨ callback ref é¿å…é—­åŒ…é™·é˜±
function Component() {
  const [value, setValue] = useState(0);

  const handleChange = useCallback((newValue) => {
    setValue(newValue);
  }, []);

  return <Child onChange={handleChange} />;
}
```

---

## ä¸ƒã€å¸¸è§é—®é¢˜ä¸é¿å‘æŒ‡å—

### âŒ é—®é¢˜ 1ï¼šè¿‡åº¦ä½¿ç”¨å…¨å±€çŠ¶æ€

```typescript
// âŒ æ‰€æœ‰çŠ¶æ€éƒ½ç”¨ Redux
function LoginForm() {
  const dispatch = useDispatch();

  const [username, setUsername] = useState(''); // âœ… å±€éƒ¨çŠ¶æ€ç”¨ useState
  const [password, setPassword] = useState('');

  const handleSubmit = () => {
    dispatch(login({ username, password })); // âœ… ä»…æäº¤æ—¶ç”¨å…¨å±€çŠ¶æ€
  };
}
```

### âŒ é—®é¢˜ 2ï¼šç›´æ¥ä¿®æ”¹ state

```typescript
// âŒ ç›´æ¥ä¿®æ”¹
state.items.push(newItem);

// âœ… åˆ›å»ºæ–°å¯¹è±¡
return {
  ...state,
  items: [...state.items, newItem]
};

// âœ… Immerï¼ˆRedux Toolkit å†…ç½®ï¼‰
state.items.push(newItem); // Immer ä¼šè‡ªåŠ¨å¤„ç†
```

### âŒ é—®é¢˜ 3ï¼šåœ¨ render ä¸­æ´¾ç”ŸçŠ¶æ€

```typescript
// âŒ æ¯æ¬¡ render éƒ½è®¡ç®—
function Component() {
  const users = useAppSelector(state => state.users);
  const activeUsers = users.filter(user => user.isActive);

  return <UserList users={activeUsers} />;
}

// âœ… ä½¿ç”¨ useMemo
function Component() {
  const users = useAppSelector(state => state.users);
  const activeUsers = useMemo(
    () => users.filter(user => user.isActive),
    [users]
  );

  return <UserList users={activeUsers} />;
}

// âœ… æˆ–åœ¨ selector ä¸­è®¡ç®—
const activeUsersSelector = createSelector(
  [(state) => state.users],
  (users) => users.filter(user => user.isActive)
);
```

---

## å…«ã€æ€»ç»“ä¸è®°å¿†è¦ç‚¹

### ğŸ¯ æ ¸å¿ƒè®°å¿†å£è¯€

```
ç®€å•çŠ¶æ€ useState
ç»„ä»¶ä¼ é€’ Props Drilling
è·¨ç»„ä»¶å…±äº« Context
å¤æ‚åº”ç”¨ Redux Toolkit
è½»é‡é¡¹ç›® Zustand
åŸå­åŒ–çŠ¶æ€ Jotai
æœåŠ¡å™¨çŠ¶æ€ React Query
URL çŠ¶æ€ Router
åˆ’åˆ†åŸåˆ™æŒ‰åœºæ™¯
æ€§èƒ½ä¼˜åŒ–è®°å¿ƒä¸Š
```

### ğŸ“š å…³é”®æŠ€æœ¯ç‚¹

1. **Context API**ï¼šReact å†…ç½®ã€é€‚åˆä¸­å°å‹åº”ç”¨
2. **Redux Toolkit**ï¼šå¤§å‹åº”ç”¨ã€ç”Ÿæ€ä¸°å¯Œ
3. **Zustand**ï¼šè½»é‡çº§ã€ç®€æ´ã€æ€§èƒ½å¥½
4. **Jotai**ï¼šåŸå­åŒ–ã€çµæ´»ã€ç»„åˆæ€§å¼º
5. **çŠ¶æ€åˆ’åˆ†**ï¼šUIã€æœåŠ¡å™¨ã€å…¨å±€ã€URL çŠ¶æ€
6. **æ€§èƒ½ä¼˜åŒ–**ï¼šé€‰æ‹©æœ€å°çŠ¶æ€ã€useMemoã€useCallback

---

## ä¹ã€å®æˆ˜ç»ƒä¹ å»ºè®®

1. ç”¨ Context API å®ç°ä¸»é¢˜åˆ‡æ¢
2. ç”¨ Redux Toolkit æ„å»ºå®Œæ•´çš„ CRUD åº”ç”¨
3. ç”¨ Zustand é‡æ„ Redux é¡¹ç›®
4. ç”¨ Jotai å®ç°è¡¨å•çŠ¶æ€ç®¡ç†
5. ç»“åˆ React Query å¤„ç†æœåŠ¡å™¨çŠ¶æ€

---

**ä¸‹ä¸€æ­¥å­¦ä¹ **ï¼šğŸ‘‰ [React ç”Ÿæ€ç³»ç»Ÿ](./ç”Ÿæ€ç³»ç»Ÿ.md)
