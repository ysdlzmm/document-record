# æ€§èƒ½ä¼˜åŒ–

## ä¸€ã€æ€§èƒ½ä¼˜åŒ–æ ¸å¿ƒåŸåˆ™

### 1.1 æ€§èƒ½æŒ‡æ ‡

**æ ¸å¿ƒ Web æŒ‡æ ‡ï¼ˆCore Web Vitalsï¼‰**

| æŒ‡æ ‡ | åç§° | è‰¯å¥½å€¼ | è¡¡é‡å†…å®¹ |
|------|------|--------|----------|
| **LCP** | Largest Contentful Paint | < 2.5s | æœ€å¤§å†…å®¹ç»˜åˆ¶ï¼ˆåŠ è½½æ€§èƒ½ï¼‰ |
| **FID** | First Input Delay | < 100ms | é¦–æ¬¡è¾“å…¥å»¶è¿Ÿï¼ˆäº¤äº’æ€§ï¼‰ |
| **CLS** | Cumulative Layout Shift | < 0.1 | ç´¯ç§¯å¸ƒå±€åç§»ï¼ˆè§†è§‰ç¨³å®šæ€§ï¼‰ |

**å…¶ä»–é‡è¦æŒ‡æ ‡**
- **FCP** (First Contentful Paint): < 1.8s
- **TTI** (Time to Interactive): < 3.8s
- **TBT** (Total Blocking Time): < 200ms

### 1.2 æ€§èƒ½åˆ†æå·¥å…·

```javascript
// Performance API
// æµ‹é‡é¡µé¢åŠ è½½
window.addEventListener('load', () => {
  const perfData = performance.getEntriesByType('navigation')[0];

  console.log({
    // DNS æŸ¥è¯¢æ—¶é—´
    dns: perfData.domainLookupEnd - perfData.domainLookupStart,
    // TCP è¿æ¥æ—¶é—´
    tcp: perfData.connectEnd - perfData.connectStart,
    // è¯·æ±‚å“åº”æ—¶é—´
    request: perfData.responseEnd - perfData.requestStart,
    // DOM è§£ææ—¶é—´
    domParse: perfData.domInteractive - perfData.responseEnd,
    // DOM å®Œå…¨åŠ è½½æ—¶é—´
    domComplete: perfData.domComplete - perfData.domInteractive,
    // å®Œæ•´åŠ è½½æ—¶é—´
    loadTime: perfData.loadEventEnd - perfData.fetchStart
  });
});

// æµ‹é‡èµ„æºåŠ è½½
const resources = performance.getEntriesByType('resource');
resources.forEach(resource => {
  console.log(`${resource.name}: ${resource.duration}ms`);
});

// ç”¨æˆ·æ ‡è®°
performance.mark('start-task');

// æ‰§è¡Œä»»åŠ¡
doSomething();

performance.mark('end-task');
performance.measure('task-duration', 'start-task', 'end-task');

const measure = performance.getEntriesByName('task-duration')[0];
console.log(`ä»»åŠ¡è€—æ—¶: ${measure.duration}ms`);
```

---

## äºŒã€åŠ è½½ä¼˜åŒ–

### 2.1 èµ„æºåŠ è½½ä¼˜åŒ–

```html
<!-- é¢„åŠ è½½å…³é”®èµ„æº -->
<head>
  <!-- DNS é¢„è§£æ -->
  <link rel="dns-prefetch" href="//cdn.example.com" />

  <!-- é¢„è¿æ¥ï¼ˆTCP + TLSï¼‰ -->
  <link rel="preconnect" href="https://api.example.com" />

  <!-- é¢„åŠ è½½å…³é”® CSS/JS/å­—ä½“ -->
  <link rel="preload" href="critical.css" as="style" />
  <link rel="preload" href="main.js" as="script" />
  <link rel="preload" href="font.woff2" as="font" crossorigin />

  <!-- é¢„è·å–å¯èƒ½ç”¨åˆ°çš„èµ„æº -->
  <link rel="prefetch" href="next-page.js" />

  <!-- é¢„æ¸²æŸ“ä¸‹ä¸€ä¸ªé¡µé¢ï¼ˆChromeï¼‰ -->
  <link rel="prerender" href="next-page.html" />
</head>

<!-- è„šæœ¬åŠ è½½ç­–ç•¥ -->
<script defer src="app.js"></script> <!-- æ¨èï¼šè§£æå®Œæ‰§è¡Œ -->
<script async src="analytics.js"></script> <!-- ç‹¬ç«‹åŠ è½½ -->

<!-- æ¨¡å—è„šæœ¬è‡ªåŠ¨ defer -->
<script type="module" src="app.js"></script>
```

### 2.2 ä»£ç åˆ†å‰²

```javascript
// è·¯ç”±çº§åˆ†å‰²
import { lazy, Suspense } from 'react';

const Home = lazy(() => import('./routes/Home'));
const About = lazy(() => import('./routes/About'));

function App() {
  return (
    <Suspense fallback={<Loading />}>
      <Routes>
        <Route path="/" element={<Home />} />
        <Route path="/about" element={<About />} />
      </Routes>
    </Suspense>
  );
}

// ç»„ä»¶çº§åˆ†å‰²
const HeavyChart = lazy(() => import('./components/HeavyChart'));

function Dashboard() {
  const [showChart, setShowChart] = useState(false);

  return (
    <div>
      <button onClick={() => setShowChart(true)}>
        æ˜¾ç¤ºå›¾è¡¨
      </button>
      {showChart && (
        <Suspense fallback={<div>åŠ è½½ä¸­...</div>}>
          <HeavyChart />
        </Suspense>
      )}
    </div>
  );
}

// æ¡ä»¶åˆ†å‰²
const AdminPanel = lazy(() =>
  import('./components/AdminPanel')
);

function App() {
  const isAdmin = checkAdmin();

  return (
    <div>
      {isAdmin && (
        <Suspense fallback={null}>
          <AdminPanel />
        </Suspense>
      )}
    </div>
  );
}
```

### 2.3 Tree Shaking

```javascript
// âœ… ä½¿ç”¨ ES Module
// utils.js
export function add(a, b) {
  return a + b;
}

export function subtract(a, b) {
  return a - b;
}

// main.js
import { add } from './utils'; // åªæ‰“åŒ… add

// âŒ CommonJS æ— æ³• Tree Shaking
// utils.js
module.exports.add = function(a, b) {
  return a + b;
};

// main.js
const { add } = require('./utils'); // æ‰“åŒ…æ•´ä¸ª utils

// package.json æ ‡è®°æ— å‰¯ä½œç”¨
{
  "sideEffects": false, // æ•´ä¸ªåŒ…æ— å‰¯ä½œç”¨
  "sideEffects": ["*.css", "*.scss"] // ä»… CSS æœ‰å‰¯ä½œç”¨
}
```

### 2.4 å‹ç¼©ä¸æ··æ·†

```javascript
// Webpack Terser é…ç½®
new TerserPlugin({
  terserOptions: {
    compress: {
      drop_console: true, // åˆ é™¤ console
      drop_debugger: true,
      pure_funcs: ['console.log'], // ä»…åˆ é™¤ç‰¹å®šå‡½æ•°
      dead_code: true, // åˆ é™¤æ­»ä»£ç 
      unused: true // åˆ é™¤æœªä½¿ç”¨ä»£ç 
    },
    mangle: {
      reserved: ['React'] // ä¿ç•™ç‰¹å®šåç§°ä¸æ··æ·†
    }
  }
});
```

---

## ä¸‰ã€æ¸²æŸ“ä¼˜åŒ–

### 3.1 å‡å°‘ DOM æ“ä½œ

```javascript
// âŒ é¢‘ç¹ DOM æ“ä½œ
function appendItems(items) {
  items.forEach(item => {
    const div = document.createElement('div');
    div.textContent = item;
    document.body.appendChild(div); // å¤šæ¬¡é‡æ’é‡ç»˜
  });
}

// âœ… ä½¿ç”¨æ–‡æ¡£ç‰‡æ®µæ‰¹é‡æ·»åŠ 
function appendItems(items) {
  const fragment = document.createDocumentFragment();

  items.forEach(item => {
    const div = document.createElement('div');
    div.textContent = item;
    fragment.appendChild(div); // å†…å­˜ä¸­æ“ä½œ
  });

  document.body.appendChild(fragment); // ä¸€æ¬¡æ€§æ·»åŠ 
}

// âœ… æ›´å¥½çš„æ–¹å¼ï¼šä½¿ç”¨ innerHTMLï¼ˆæ³¨æ„ XSSï¼‰
function appendItems(items) {
  const html = items.map(item => `<div>${item}</div>`).join('');
  document.body.insertAdjacentHTML('beforeend', html);
}
```

### 3.2 è™šæ‹Ÿæ»šåŠ¨

```jsx
// ä½¿ç”¨ react-window
import { FixedSizeList } from 'react-window';

function VirtualizedList({ items }) {
  const Row = ({ index, style }) => (
    <div style={style}>
      {items[index].name}
    </div>
  );

  return (
    <FixedSizeList
      height={400}
      width="100%"
      itemSize={50}
      itemCount={items.length}
    >
      {Row}
    </FixedSizeList>
  );
}

// æ‰‹åŠ¨å®ç°è™šæ‹Ÿæ»šåŠ¨
class VirtualScroll {
  constructor(options) {
    this.options = options;
    this.viewportHeight = options.viewportHeight;
    this.itemHeight = options.itemHeight;
    this.totalItems = options.totalItems;
    this.scrollTop = 0;
  }

  getVisibleRange() {
    const start = Math.floor(this.scrollTop / this.itemHeight);
    const visibleCount = Math.ceil(this.viewportHeight / this.itemHeight);
    const end = Math.min(start + visibleCount + 2, this.totalItems);

    return { start, end };
  }

  render() {
    const { start, end } = this.getVisibleRange();
    const offsetY = start * this.itemHeight;

    // åªæ¸²æŸ“å¯è§é¡¹
    return {
      offsetY,
      visibleItems: this.options.items.slice(start, end)
    };
  }
}
```

### 3.3 é˜²æŠ–ä¸èŠ‚æµ

```javascript
// é˜²æŠ–ï¼šå»¶è¿Ÿæ‰§è¡Œï¼Œé‡å¤è§¦å‘é‡ç½®è®¡æ—¶å™¨
function debounce(fn, delay) {
  let timer = null;

  return function(...args) {
    clearTimeout(timer);
    timer = setTimeout(() => {
      fn.apply(this, args);
    }, delay);
  };
}

// ä½¿ç”¨åœºæ™¯ï¼šæœç´¢è¾“å…¥
const searchInput = document.getElementById('search');
searchInput.addEventListener('input', debounce(function(e) {
  performSearch(e.target.value);
}, 300));

// èŠ‚æµï¼šå›ºå®šæ—¶é—´é—´éš”æ‰§è¡Œ
function throttle(fn, delay) {
  let last = 0;

  return function(...args) {
    const now = Date.now();

    if (now - last >= delay) {
      last = now;
      fn.apply(this, args);
    }
  };
}

// ä½¿ç”¨åœºæ™¯ï¼šæ»šåŠ¨äº‹ä»¶
window.addEventListener('scroll', throttle(function() {
  updateScrollPosition();
}, 100));

// requestAnimationFrame ç‰ˆæœ¬ï¼ˆæ›´å¹³æ»‘ï¼‰
function throttleRAF(fn) {
  let ticking = false;

  return function(...args) {
    if (!ticking) {
      requestAnimationFrame(() => {
        fn.apply(this, args);
        ticking = false;
      });
      ticking = true;
    }
  };
}

window.addEventListener('scroll', throttleRAF(function() {
  updateScrollPosition();
}));
```

### 3.4 æ‰¹é‡æ›´æ–°

```jsx
// âŒ å¤šæ¬¡ setState
function BadComponent() {
  const [count, setCount] = useState(0);
  const [name, setName] = useState('');

  const handleClick = () => {
    setCount(count + 1); // è§¦å‘é‡æ¸²æŸ“
    setName('å¼ ä¸‰');     // è§¦å‘é‡æ¸²æŸ“
    setCount(count + 2); // è§¦å‘é‡æ¸²æŸ“
  };
}

// âœ… æ‰¹é‡æ›´æ–°ï¼ˆReact 18 è‡ªåŠ¨æ‰¹å¤„ç†ï¼‰
function GoodComponent() {
  const [count, setCount] = useState(0);
  const [name, setName] = useState('');

  const handleClick = () => {
    // React 18 è‡ªåŠ¨æ‰¹å¤„ç†
    setCount(count + 1);
    setName('å¼ ä¸‰');
    setCount(count + 2);
    // åªè§¦å‘ä¸€æ¬¡é‡æ¸²æŸ“
  };
}

// æ‰‹åŠ¨æ‰¹é‡æ›´æ–°
import { unstable_batchedUpdates } from 'react-dom';

function fetchData() {
  unstable_batchedUpdates(() => {
    setUser(data.user);
    setPosts(data.posts);
    setComments(data.comments);
  });
}
```

---

## å››ã€ç½‘ç»œä¼˜åŒ–

### 4.1 HTTP ç¼“å­˜

```javascript
// æœåŠ¡ç«¯è®¾ç½®ç¼“å­˜å¤´ï¼ˆNode.js Express ç¤ºä¾‹ï¼‰
app.use(express.static('dist', {
  maxAge: '1y', // é™æ€èµ„æºé•¿æœŸç¼“å­˜
  immutable: true
}));

// API ç¼“å­˜
app.get('/api/users', (req, res) => {
  res.set('Cache-Control', 'public, max-age=3600'); // 1 å°æ—¶
  res.json(users);
});

// æµè§ˆå™¨ç¼“å­˜ç­–ç•¥
// å¼ºç¼“å­˜ï¼šCache-Control
// åå•†ç¼“å­˜ï¼šETag / Last-Modified
```

### 4.2 CDN åŠ é€Ÿ

```javascript
// åŠ¨æ€åŠ è½½ CDN èµ„æº
function loadScript(url) {
  return new Promise((resolve, reject) => {
    const script = document.createElement('script');
    script.src = url;
    script.onload = resolve;
    script.onerror = reject;
    document.head.appendChild(script);
  });
}

// æŒ‰éœ€åŠ è½½åº“
async function initMap() {
  if (!window.google) {
    await loadScript('https://maps.googleapis.com/maps/api/js');
  }
  // åˆå§‹åŒ–åœ°å›¾
}

// ä½¿ç”¨ CDN åŠ é€Ÿç¬¬ä¸‰æ–¹åº“
// <script src="https://cdn.jsdelivr.net/npm/react@18/umd/react.production.min.js"></script>
```

### 4.3 é¢„è¿æ¥ä¸é¢„åŠ è½½

```html
<!-- å…³é”®èµ„æºé¢„åŠ è½½ -->
<link rel="preload" href="critical.css" as="style" />
<link rel="preload" href="main.js" as="script" />
<link rel="preload" href="font.woff2" as="font" crossorigin />

<!-- é¢„è¿æ¥åˆ°ç¬¬ä¸‰æ–¹åŸŸå -->
<link rel="preconnect" href="https://api.example.com" />
<link rel="dns-prefetch" href="//cdn.example.com" />

<!-- é¢„è·å–ä¸‹ä¸€ä¸ªé¡µé¢èµ„æº -->
<link rel="prefetch" href="next-page.js" />
```

---

## äº”ã€ä»£ç ä¼˜åŒ–

### 5.1 é¿å…å†…å­˜æ³„æ¼

```javascript
// âŒ å®šæ—¶å™¨æœªæ¸…ç†
function startTimer() {
  setInterval(() => {
    console.log('tick');
  }, 1000); // ç»„ä»¶å¸è½½åä»åœ¨è¿è¡Œ
}

// âœ… æ¸…ç†å®šæ—¶å™¨
function startTimer() {
  const timer = setInterval(() => {
    console.log('tick');
  }, 1000);

  return () => clearInterval(timer);
}

// React ä¸­ä½¿ç”¨ useEffect æ¸…ç†
useEffect(() => {
  const timer = setInterval(() => {
    console.log('tick');
  }, 1000);

  return () => clearInterval(timer);
}, []);

// âŒ äº‹ä»¶ç›‘å¬å™¨æœªæ¸…ç†
function addClickListener() {
  document.addEventListener('click', handleClick); // å†…å­˜æ³„æ¼
}

// âœ… æ¸…ç†äº‹ä»¶ç›‘å¬å™¨
useEffect(() => {
  document.addEventListener('click', handleClick);

  return () => {
    document.removeEventListener('click', handleClick);
  };
}, []);
```

### 5.2 é¿å…å¼ºåˆ¶åŒæ­¥å¸ƒå±€

```javascript
// âŒ å¼ºåˆ¶åŒæ­¥å¸ƒå±€ï¼ˆè¯»å–åç«‹å³å†™å…¥ï¼‰
function badAnimate() {
  const elements = document.querySelectorAll('.item');

  elements.forEach(el => {
    // è¯»å–ï¼ˆè§¦å‘é‡æ’ï¼‰
    const height = el.offsetHeight;

    // å†™å…¥ï¼ˆè§¦å‘é‡æ’ï¼‰
    el.style.height = height + 10 + 'px';
  });
}

// âœ… æ‰¹é‡è¯»å–åæ‰¹é‡å†™å…¥
function goodAnimate() {
  const elements = document.querySelectorAll('.item');

  // æ‰¹é‡è¯»å–
  const heights = Array.from(elements).map(el => el.offsetHeight);

  // æ‰¹é‡å†™å…¥
  elements.forEach((el, i) => {
    el.style.height = heights[i] + 10 + 'px';
  });
}

// æ›´å¥½çš„æ–¹å¼ï¼šä½¿ç”¨ requestAnimationFrame
function betterAnimate() {
  requestAnimationFrame(() => {
    // åœ¨ä¸‹ä¸€å¸§æ‰§è¡Œï¼Œé¿å…å¸ƒå±€æŠ–åŠ¨
    elements.forEach((el, i) => {
      el.style.height = heights[i] + 10 + 'px';
    });
  });
}
```

### 5.3 å¤§æ•°æ®å¤„ç†

```javascript
// âŒ åŒæ­¥å¤„ç†å¤§æ•°æ®ï¼ˆé˜»å¡ä¸»çº¿ç¨‹ï¼‰
function processData(data) {
  return data.map(item => {
    // å¤æ‚è®¡ç®—
    return heavyComputation(item);
  });
}

// âœ… åˆ†å—å¤„ç†
function processDataInChunks(data, chunkSize = 1000) {
  let index = 0;

  function processChunk() {
    const chunk = data.slice(index, index + chunkSize);

    chunk.forEach(item => {
      heavyComputation(item);
    });

    index += chunkSize;

    if (index < data.length) {
      requestAnimationFrame(processChunk); // è®©å‡ºä¸»çº¿ç¨‹
    }
  }

  processChunk();
}

// âœ… ä½¿ç”¨ Web Worker
// worker.js
self.addEventListener('message', (e) => {
  const result = heavyComputation(e.data);
  self.postMessage(result);
});

// main.js
function processWithWorker(data) {
  return new Promise((resolve) => {
    const worker = new Worker('worker.js');

    worker.postMessage(data);

    worker.addEventListener('message', (e) => {
      resolve(e.data);
      worker.terminate();
    });
  });
}
```

---

## å…­ã€React ä¸“é¡¹ä¼˜åŒ–

### 6.1 é¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“

```jsx
// âœ… ä½¿ç”¨ React.memo
const ExpensiveComponent = React.memo(({ data }) => {
  return <div>{/* å¤æ‚æ¸²æŸ“ */}</div>;
});

// âœ… ä½¿ç”¨ useMemo ç¼“å­˜è®¡ç®—ç»“æœ
function ParentComponent({ items }) {
  const sortedItems = useMemo(() => {
    return items.sort((a, b) => a.value - b.value);
  }, [items]);

  return <ChildComponent items={sortedItems} />;
}

// âœ… ä½¿ç”¨ useCallback ç¼“å­˜å‡½æ•°
function ParentComponent() {
  const handleClick = useCallback(() => {
    console.log('clicked');
  }, []); // ä¾èµ–ä¸ºç©ºï¼Œå‡½æ•°å¼•ç”¨ä¸å˜

  return <ChildComponent onClick={handleClick} />;
}
```

### 6.2 è™šæ‹ŸåŒ–é•¿åˆ—è¡¨

```jsx
// ä½¿ç”¨ react-window
import { FixedSizeList } from 'react-window';

function VirtualizedList({ items }) {
  const Row = ({ index, style }) => (
    <div style={style}>
      {items[index].name}
    </div>
  );

  return (
    <FixedSizeList
      height={400}
      width="100%"
      itemSize={50}
      itemCount={items.length}
    >
      {Row}
    </FixedSizeList>
  );
}
```

### 6.3 æ‡’åŠ è½½ç»„ä»¶

```jsx
import { lazy, Suspense } from 'react';

const HeavyComponent = lazy(() => import('./HeavyComponent'));

function App() {
  return (
    <Suspense fallback={<div>åŠ è½½ä¸­...</div>}>
      <HeavyComponent />
    </Suspense>
  );
}
```

---

## ä¸ƒã€ç›‘æ§ä¸åˆ†æ

### 7.1 æ€§èƒ½ç›‘æ§

```javascript
// Performance Observer API
const observer = new PerformanceObserver((list) => {
  list.getEntries().forEach((entry) => {
    console.log(entry.name, entry.duration);
  });
});

observer.observe({ entryTypes: ['measure', 'navigation', 'resource'] });

// ç›‘æ§ Core Web Vitals
import { getCLS, getFID, getFCP, getLCP, getTTFB } from 'web-vitals';

getCLS(console.log);
getFID(console.log);
getFCP(console.log);
getLCP(console.log);
getTTFB(console.log);

// è‡ªå®šä¹‰æ€§èƒ½ç›‘æ§
function trackPerformance() {
  // é¡µé¢åŠ è½½æ—¶é—´
  window.addEventListener('load', () => {
    const perfData = performance.getEntriesByType('navigation')[0];
    const loadTime = perfData.loadEventEnd - perfData.fetchStart;

    // ä¸ŠæŠ¥åˆ°åˆ†æå¹³å°
    analytics.track('page_load_time', {
      value: loadTime,
      url: window.location.href
    });
  });

  // API è¯·æ±‚æ—¶é—´
  const originalFetch = window.fetch;
  window.fetch = async function(...args) {
    const start = performance.now();
    const response = await originalFetch(...args);
    const duration = performance.now() - start;

    analytics.track('api_request', {
      url: args[0],
      duration,
      status: response.status
    });

    return response;
  };
}
```

### 7.2 é”™è¯¯ç›‘æ§

```javascript
// å…¨å±€é”™è¯¯æ•è·
window.addEventListener('error', (event) => {
  console.error('Global error:', event.error);

  // ä¸ŠæŠ¥é”™è¯¯
  errorTracker.captureException(event.error);
});

// Promise é”™è¯¯æ•è·
window.addEventListener('unhandledrejection', (event) => {
  console.error('Unhandled promise rejection:', event.reason);

  // ä¸ŠæŠ¥é”™è¯¯
  errorTracker.captureException(event.reason);
});

// React é”™è¯¯è¾¹ç•Œ
class ErrorBoundary extends React.Component {
  state = { hasError: false, error: null };

  static getDerivedStateFromError(error) {
    return { hasError: true, error };
  }

  componentDidCatch(error, errorInfo) {
    // ä¸ŠæŠ¥é”™è¯¯
    errorTracker.captureException(error, {
      context: errorInfo
    });
  }

  render() {
    if (this.state.hasError) {
      return <ErrorFallback error={this.state.error} />;
    }

    return this.props.children;
  }
}
```

### 7.3 æ€§èƒ½åˆ†æå·¥å…·

```bash
# Lighthouseï¼ˆå‘½ä»¤è¡Œï¼‰
npx lighthouse https://example.com --output html --output-path report.html

# Webpack Bundle Analyzer
npm install --save-dev webpack-bundle-analyzer

// webpack.config.js
const BundleAnalyzerPlugin = require('webpack-bundle-analyzer').BundleAnalyzerPlugin;

module.exports = {
  plugins: [
    new BundleAnalyzerPlugin({
      analyzerMode: 'static',
      openAnalyzer: false
    })
  ]
};

# Chrome DevTools
# 1. Performance é¢æ¿ï¼šè®°å½•è¿è¡Œæ—¶æ€§èƒ½
# 2. Network é¢æ¿ï¼šåˆ†æç½‘ç»œè¯·æ±‚
# 3. Coverage é¢æ¿ï¼šæŸ¥çœ‹æœªä½¿ç”¨çš„ä»£ç 
# 4. Lighthouse é¢æ¿ï¼šç»¼åˆæ€§èƒ½è¯„åˆ†
```

---

## å…«ã€å¸¸è§é—®é¢˜ä¸é¿å‘æŒ‡å—

### âŒ é—®é¢˜ 1ï¼šè¿‡æ—©ä¼˜åŒ–

```javascript
// âŒ è¿‡æ—©ä¼˜åŒ–
function add(a, b) {
  return a + b + 0; // æ— æ„ä¹‰çš„ä¼˜åŒ–
}

// âœ… å…ˆä¿è¯ä»£ç å¯è¯»æ€§ï¼Œæ€§èƒ½ç“¶é¢ˆåå†ä¼˜åŒ–
function add(a, b) {
  return a + b;
}
```

### âŒ é—®é¢˜ 2ï¼šæ»¥ç”¨ memo

```jsx
// âŒ ç®€å•ç»„ä»¶ä¸éœ€è¦ memo
const SimpleComponent = React.memo(() => {
  return <div>ç®€å•å†…å®¹</div>;
});

// âœ… å¤æ‚ç»„ä»¶æ‰ç”¨ memo
const ComplexComponent = React.memo(({ data }) => {
  return (
    <div>
      {data.items.map(item => (
        <ExpensiveChild key={item.id} item={item} />
      ))}
    </div>
  );
});
```

### âŒ é—®é¢˜ 3ï¼šåŒæ­¥é˜»å¡

```javascript
// âŒ åŒæ­¥å¤„ç†å¤§æ•°æ®
function processLargeArray(data) {
  return data.map(item => heavyComputation(item)); // é˜»å¡ä¸»çº¿ç¨‹
}

// âœ… åˆ†æ‰¹æˆ–å¼‚æ­¥å¤„ç†
async function processLargeArray(data) {
  const results = [];
  const chunkSize = 1000;

  for (let i = 0; i < data.length; i += chunkSize) {
    const chunk = data.slice(i, i + chunkSize);
    const processed = chunk.map(item => heavyComputation(item));
    results.push(...processed);

    // è®©å‡ºä¸»çº¿ç¨‹
    await new Promise(resolve => setTimeout(resolve, 0));
  }

  return results;
}
```

---

## ä¹ã€æ€»ç»“ä¸è®°å¿†è¦ç‚¹

### ğŸ¯ æ ¸å¿ƒè®°å¿†å£è¯€

```
åŠ è½½ä¼˜åŒ–è¦ä¼˜å…ˆ
ä»£ç åˆ†å‰²æŒ‰éœ€åŠ è½½
Tree Shaking å‡ä½“ç§¯
èµ„æºé¢„åŠ è½½æé€Ÿ
æ¸²æŸ“ä¼˜åŒ–å°‘æ“ä½œ
è™šæ‹Ÿæ»šåŠ¨é•¿åˆ—è¡¨
é˜²æŠ–èŠ‚æµæ§åˆ¶æµ
æ‰¹é‡æ›´æ–°å‡æ¸²æŸ“
ç½‘ç»œä¼˜åŒ–ç”¨ç¼“å­˜
CDN åŠ é€Ÿå…¨çƒå¿«
ä»£ç ä¼˜åŒ–é¿æ³„æ¼
åˆ†å—å¤„ç†å¤§æ•°æ®
ç›‘æ§åˆ†ææ‰¾ç“¶é¢ˆ
```

### ğŸ“š å…³é”®æŠ€æœ¯ç‚¹

1. **åŠ è½½ä¼˜åŒ–**ï¼šä»£ç åˆ†å‰²ã€Tree Shakingã€é¢„åŠ è½½
2. **æ¸²æŸ“ä¼˜åŒ–**ï¼šè™šæ‹Ÿæ»šåŠ¨ã€é˜²æŠ–èŠ‚æµã€æ‰¹é‡æ›´æ–°
3. **ç½‘ç»œä¼˜åŒ–**ï¼šHTTP ç¼“å­˜ã€CDNã€é¢„è¿æ¥
4. **ä»£ç ä¼˜åŒ–**ï¼šå†…å­˜æ³„æ¼ã€é¿å…é˜»å¡ã€Web Worker
5. **React ä¼˜åŒ–**ï¼šmemoã€useMemoã€useCallbackã€æ‡’åŠ è½½
6. **ç›‘æ§åˆ†æ**ï¼šLighthouseã€Performance APIã€é”™è¯¯ç›‘æ§

---

## åã€å®æˆ˜ç»ƒä¹ å»ºè®®

1. ä½¿ç”¨ Lighthouse åˆ†æå¹¶ä¼˜åŒ–ä¸€ä¸ªç½‘é¡µ
2. å®ç°è™šæ‹Ÿæ»šåŠ¨åˆ—è¡¨ç»„ä»¶
3. å®ç°é˜²æŠ–å’ŒèŠ‚æµ Hook
4. ä¼˜åŒ–ä¸€ä¸ªå¤§å‹ React åº”ç”¨çš„é‡æ¸²æŸ“
5. æ­å»ºå‰ç«¯æ€§èƒ½ç›‘æ§ç³»ç»Ÿ

---

**ä¸‹ä¸€æ­¥å­¦ä¹ **ï¼šğŸ‘‰ [ç›‘æ§ä¸åˆ†æ](./ç›‘æ§ä¸åˆ†æ.md)
